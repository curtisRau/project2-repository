\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage[left=2cm, right=2cm, top=2cm, bottom=2cm]{geometry}

\usepackage{amsmath}
\begin{document}
	\title{MTH 480 Project 2}
	\author{Curtis Rau, Benjamin Brophy}
	\maketitle

\section{Abstract}

\section{Introduction}

Last time we took the Schr\"{o}dinger equation and transformed it to the radial equation in center of mass frame.

\begin{equation}
	\left[ \left( = \frac{\hbar^2}{m} \frac{1}{r^2} \partial_r r^2 \partial_r + \frac{1}{4} m \omega^2 r^2 + \frac{k e^2}{r} \right) \left( - \frac{\hbar^2}{4m} \frac{1}{R^2} \partial_R R^2 \partial_R + m\omega^2 R^2 + \frac{\hbar l(l+1)}{R^2} \right) \right] \psi (r) \theta (R)  = (E_r + E_R) \psi (r) \theta (R)
\end{equation}

we are only interested in the 

\begin{equation}
\left( = \frac{\hbar^2}{m} \frac{1}{r^2} \partial_r r^2 \partial_r + \frac{1}{4} m \omega^2 r^2 + \frac{k e^2}{r} \right) \psi (r)  = E_r \psi (r)
\end{equation}

we can make the equation dimensionless which gives

\begin{equation}
\left( - \partial_\rho^2 + \rho^2 + \frac{\beta}{\rho} \right) u ( \rho ) = \lambda u(\rho ) \\
\left( - \partial_\rho^2 + V (\rho ) \right) u ( \rho ) = \lambda u(\rho )
\end{equation}

Discretize

\begin{equation}
\begin{aligned}
	u(\rho) \to u(\rho_i) = u_i \\
	\rho \to \rho_i = \rho_0 + i h \\
	h = \frac{b-a}{n+1} \\
	a = 0
\end{aligned}
\end{equation}


the linear algebra equation is

\begin{equation}
\hat{A} = 
\left( \begin{array}{cccc}
	 \frac{2}{h^2} + V_1 &    -\frac{1}{h^2}   &                &                        \\
	-\frac{1}{h^2}       & \frac{2}{h^2} + V_2 & -\frac{1}{h^2} &                        \\
	                     &                     &     \ddots     &                        \\
	                     &                     &                &    -\frac{1}{h^2}      \\
	                     &                     & -\frac{1}{h^2} & \frac{2}{h^2} + V_{N-1}
   \end{array} \right)
\end{equation}

\begin{eqnarray}
\hat{A} x = \lambda x \\
S^T A x = \lambda S^T x \\
S^T A S (S^T x) = \lambda (S^T x)
\end{eqnarray}

Eigenvalues unchanged under orthogonal transforms

Eigenvectors change, but the length is preserved

Dot product between vectors is conserved

\section{Methods}

We discretize the equation as follows, where b and a are the end points of our model using N internal points. (There are N+2 total including end points)

\begin{equation}
\begin{aligned}
u(\rho) \to u(\rho_i) = u_i \\
\rho \to \rho_i = \rho_0 + i h \\
h = \frac{b-a}{n+1} \\
a = 0
\end{aligned}
\end{equation}

And use the following expression as an approximation of the second derivative:

$$u''=\frac{u(\rho+h)-2u(\rho)+u(\rho-h)}{h^2}$$

We can approximate the Schr\"odinger equation as 

$$\frac{u_{i+1}-2u_i+u_{i-1}}{h^2}+V_iu_i=\lambda u(\rho_i)$$

In terms of matrices, we have

\begin{equation}
\left( \begin{array}{cccc}
\frac{2}{h^2} + V_1 &    -\frac{1}{h^2}   &                &   0 \\
-\frac{1}{h^2}       & \frac{2}{h^2} + V_2 & -\frac{1}{h^2} &   \\
&                     &     \ddots     &                        \\
&                     &                &    -\frac{1}{h^2}      \\
0&                     & -\frac{1}{h^2} & \frac{2}{h^2} + V_{N-1}
\end{array} \right)
\left( \begin{array}{cccc}
u_1\\
u_2\\
\dots\\
\\
\\
u_{N}\\
\end{array} \right)
=\lambda
\left( \begin{array}{cccc}
u_1\\
u_2\\
\dots\\
\\
\\
u_{N}\\
\end{array} \right)
\end{equation}
We will call the NxN matrix $\hat{A}$. We will perform a Jacobi rotation on this matrix, represented by multiplying both sides by $S_{ij}^T$, which as an identity matrix except with $c=cos\theta$ in positions $i,i$ and $j,j$, $s=sin\theta$ at position $i,j$, and $-s$ at position $j,i$ for some angle $\theta$.

\begin{equation}
S_{ij}^T = 
\left( \begin{array}{ccccccc}
1 &       &       &       &       &     &        0 \\
	 &\ddots &     &       &       &     &              \\
	 &       &  c    & \dots&  s    &     &              \\
	 &       &\vdots &       & \vdots&     &              \\
	 &       &   -s  & \dots &   c   &     &              \\
	 &       &       &       &       &\ddots&             \\
0 &       &       &       &       &     &   1  \\
\end{array} \right)
\end{equation} 


Note that:
\begin{itemize}  
\item Eigenvalues unchanged under orthogonal transforms such as a Jacobi rotation.
\item Eigenvectors change, but the length is preserved.
\item Dot product between vectors is conserved
\end{itemize}

\begin{eqnarray}
\hat{A} x = \lambda x \\
S^T A x = \lambda S^T x \\
S^T A S (S^T x) = \lambda (S^T x)
\end{eqnarray}

The values in the new matrix $\hat{A'}=S_{ij}^T\hat{A}$ can be found with the following relations, where $s=sin\theta$ and $c=cos\theta$ for some $\theta$:

\begin{eqnarray}
\hat{A'}_{ii} = c^2\hat{A}_{ii} - 2sc\hat{A}_{ij} + s^2\hat{A}_{jj} \\
\hat{A'}_{jj} = s^2\hat{A}_{ii} + 2sc\hat{A}_{ij} + c^2\hat{A}_{jj} \\
\hat{A'}_{ij} = \hat{A'}_{ji} = (c^2 - s^2)\hat{A}_{ij} + sc(\hat{A}_{ii} - \hat{A'}_{jj} )  \\
\hat{A'}_{ik} = \hat{A'}_{ki} = c\hat{A}_{ik} - s\hat{A}_{jk}, k\not= i,j \\
\hat{A'}_{jk} = \hat{A'}_{kj} = s\hat{A}_{ik} - c\hat{A}_{jk}, k\not= i,j \\
\hat{A'}_{kl} = \hat{A}_{kl} ,  k,l\not= i, 
\end{eqnarray}



We performed a Jacobian eigenvalue algorithm on this matrix to find the approximate eigenvalues. If we minimize all of the off-diagonal elements with orthogonal transforms, which preserve eigenvalues, then the remaining diagonal gives us the approximate eigenvalues of the matrix. A Jacobi rotation is one such orthogonal transform.

In our method, we first identify the largest off-diagonal element $A_{i,j}$ to use as the "pivot" in the Jacobi Rotation. So, we find the angle of rotation such that $A_{i,j}$ becomes zero. We perform a Jacobi rotation of that angle on $\hat{A}$ and call the rotated matrix our new $\hat{A}$.

 We repeat this process until either the largest off-diagonal element has absolute value less than a certain tolerance, 0.01, or until a maximum number of iterations is reached.

After many iterations, the off diagonal elements are minimized while the diagonals elements approach eigenvalues. 


\section{Analysis}

- for part B, using N = 200 and rhoMax = 5.0 gives the three lowest eigenvalues up to 3 decimal places.

\subsection{Part B}

\begin{table}
	\centering
	\begin{tabular}{ r | l || c | c | r | c | c}
		Size of &           & Householder & Jacobi & Itterations of & Jacobi & Householder \\
		Matrix  & Tolerance &    Time     &  Time  & Jacobi Method  &   E1   &      E1     \\
		\hline
		 100 & 0.1    & 0.01 &  0.15 &  8684 & 3.00030 & 3.22937 \\
		  "  & 0.01   &  "   &  0.20 & 10667 & 2.99924 &    "    \\
		  "  & 0.001  &  "   &  0.21 & 12076 & 2.99923 &    "    \\
		  "  & 0.0001 &  "   &  0.25 & 13200 &    "    &    "    \\
		 200 & 0.1    & 0.1  &  2.5  & 36836 & 3.00228 & 2.99986 \\
		  "  & 0.01   &  "   &  2.9  & 44012 & 2.99981 &    "    \\
		  "  & 0.001  &  "   &  3.2  & 49387 &    "    &    "    \\
		  "  & 0.0001 &  "   &  3.6  & 53888 &    "    &    "    \\
		 300 & 0.1    & 0.38 & 12.2  & 85521 & 3.00024 & 3.00000 \\
		 500 &        & 2.9  &       &       &         & 3.00003 \\
		 750 &        & 9.7  &       &       &         & 3.00006 \\ 
		1000 &        & 54.6 &       &       &         & 2.99967 \\
		
	\end{tabular}
	\caption{rhoMax = 5.0}
\end{table}


\section{Conclusions}

\section{Works Cited}



\end{document}
